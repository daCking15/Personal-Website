<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Tanks 3D - Chris King</title>
    <link rel="stylesheet" href="index.css" />
    <link rel="icon" href="assets/favicon.ico" />
    <!-- Bootstrap CSS CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  </head>
  <body class="min-vh-100">
    <div class="container-fluid min-vh-100">
      <div class="row min-vh-100 g-0">
        <div id="sidebar-container" class="col-12 col-md-3"></div>
        <div class="col-12 col-md-9 p-0" style="overflow-y: auto; max-height: 100vh;">
          <div id="projects-container" class="d-flex flex-column">
            <div id="project-tanks" class="project-card bg-white px-5 py-5" style="min-height: 100vh; width: 100%; display: flex; flex-direction: column; justify-content: center; max-width: 1200px; margin: 0 auto;">
              <div class="mb-5">
                <h2 class="display-5 fw-bold mb-3 text-dark">Tanks 3D</h2>
                <div class="mb-4">
                  <a href="https://drive.google.com/uc?export=download&id=16STLGbwajvYpD5MunB-OGidT-obHGsD7" target="_blank" rel="noopener noreferrer" class="btn btn-outline-primary me-2 mb-2">Tanks 3D - Windows 10</a>
                  <a href="https://drive.google.com/uc?export=download&id=11Kp5cgR9fHswsE3t8Q2KrGWMPZwPHAfC" target="_blank" rel="noopener noreferrer" class="btn btn-outline-primary me-2 mb-2">Tanks 3D - Web GL</a>
                  <a href="https://drive.google.com/uc?export=download&id=17zlwyktAkVkoSAS7mygB7l8T4V9aqgcK" target="_blank" rel="noopener noreferrer" class="btn btn-outline-primary me-2 mb-2">Controls</a>
                </div>
              </div>
              <div class="mb-4">
                <div id="tanksCarousel" class="carousel slide">
                  <div class="carousel-indicators">
                    <button type="button" data-bs-target="#tanksCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#tanksCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                  </div>
                  <div class="carousel-inner rounded shadow-sm">
                    <div class="carousel-item active">
                      <img src="assets/Tanks3D.png" alt="Tanks 3D" class="d-block w-100" style="max-height: 60vh; object-fit: contain;">
                    </div>
                    <div class="carousel-item">
                      <img src="assets/Tanks 3D Controls.jpg" alt="Tanks 3D Controls" class="d-block w-100" style="max-height: 60vh; object-fit: contain;">
                    </div>
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#tanksCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon arrow-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#tanksCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon arrow-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
              </div>
              <div class="mt-3">
                <p class="lead text-muted mb-0" style="line-height: 1.8;">An independently developed local multiplayer game based off <a href="https://www.addictinggames.com/strategy/tanks" target="_blank" rel="noopener">Tanks</a>.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Bootstrap JS (optional, for advanced features) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"></script>
    <!-- Sidebar -->
    <script src="sidebar.js"></script>
    <script>
      // Load sidebar
      if (typeof loadSidebar === 'function') {
        loadSidebar('project-tanks');
      }
      
      // Function to detect brightness and adjust arrow colors
      function adjustArrowColors() {
        const carousel = document.getElementById('tanksCarousel');
        const activeItem = carousel.querySelector('.carousel-item.active');
        const img = activeItem ? activeItem.querySelector('img') : null;
        
        if (!img || !img.complete) {
          // Wait for image to load
          if (img) {
            img.addEventListener('load', adjustArrowColors);
          }
          return;
        }
        
        // Create canvas to sample image pixels
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = img.naturalWidth || img.width;
        canvas.height = img.naturalHeight || img.height;
        
        ctx.drawImage(img, 0, 0);
        
        // Sample pixels from left and right edges (where arrows are)
        const sampleWidth = Math.max(50, canvas.width * 0.1);
        const sampleHeight = canvas.height;
        
        // Sample left edge (for prev arrow)
        const leftPixels = ctx.getImageData(0, 0, sampleWidth, sampleHeight);
        const leftBrightness = calculateBrightness(leftPixels);
        
        // Sample right edge (for next arrow)
        const rightPixels = ctx.getImageData(canvas.width - sampleWidth, 0, sampleWidth, sampleHeight);
        const rightBrightness = calculateBrightness(rightPixels);
        
        // Adjust arrow colors based on brightness
        const arrows = document.querySelectorAll('.arrow-icon');
        const prevArrow = document.querySelector('.carousel-control-prev .arrow-icon');
        const nextArrow = document.querySelector('.carousel-control-next .arrow-icon');
        
        // Threshold: if brightness > 128, use dark arrows; otherwise use light
        if (prevArrow) {
          if (leftBrightness > 128) {
            prevArrow.style.filter = 'invert(1) brightness(0.3)';
          } else {
            prevArrow.style.filter = 'none';
          }
        }
        
        if (nextArrow) {
          if (rightBrightness > 128) {
            nextArrow.style.filter = 'invert(1) brightness(0.3)';
          } else {
            nextArrow.style.filter = 'none';
          }
        }
      }
      
      // Calculate average brightness from image data
      function calculateBrightness(imageData) {
        const data = imageData.data;
        let sum = 0;
        let count = 0;
        
        // Sample every 10th pixel for performance
        for (let i = 0; i < data.length; i += 40) {
          const r = data[i];
          const g = data[i + 1];
          const b = data[i + 2];
          // Calculate luminance (perceived brightness)
          const luminance = (0.299 * r + 0.587 * g + 0.114 * b);
          sum += luminance;
          count++;
        }
        
        return count > 0 ? sum / count : 128;
      }
      
      // Adjust arrows when carousel slides
      const carousel = document.getElementById('tanksCarousel');
      if (carousel) {
        carousel.addEventListener('slid.bs.carousel', adjustArrowColors);
        
        // Adjust on initial load
        window.addEventListener('load', () => {
          setTimeout(adjustArrowColors, 100);
        });
        
        // Also adjust when images load
        const images = carousel.querySelectorAll('img');
        images.forEach(img => {
          if (img.complete) {
            adjustArrowColors();
          } else {
            img.addEventListener('load', adjustArrowColors);
          }
        });
      }
    </script>
  </body>
</html>
